<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="css/leaflet.css">
        <link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
        <link rel="stylesheet" href="css/qgis2web.css">
        <link rel="stylesheet" href="css/fontawesome-all.min.css">
        <link rel="stylesheet" href="css/filter.css">
        <link rel="stylesheet" href="css/nouislider.min.css">
        <link rel="stylesheet" href="css/leaflet-measure.css">
		<link rel="stylesheet" href="css/leaflet-control-credits.css" />
		<link href="css/Leaflet_GraphicScale_min.css" rel="stylesheet" type="text/css">
		<link rel="stylesheet" href="css/LControlMousePosition.css" />
		<link rel="stylesheet" href="css/leaflet.zoomhome.css"/>
		<link href="css/introLoader.css" rel="stylesheet">
	    <link rel="stylesheet" href="css/Leaflet.BigImage.css">
		<link rel="stylesheet" type="text/css" href="css/leaflet-history.css">
		<link rel="stylesheet" href="css/leaflet-sidepanel.css" />
        <link rel="stylesheet" type="text/css" href="css/leaflet.scalefactor.css">
		
		<style>
        html, body {  width: 100%;height: 100%; padding: 0; margin: 0; background-color:#ececec42!important; overflow-y: hidden;}
		#map{ width: 100%; height: 100%; padding: 0; margin: 0; overflow-y: hidden;}
		#beta { position:fixed; left:38%; bottom:40px; z-index: 1050;  display:block; margin:0px auto;  text-align:center;}
		@media (min-width: 1080px) {#beta{ bottom:40px;}}
		.col9{width: 100% !important; height: 100%!important;	background-color:transparent!important;}
		.col3{width: 100% !important;	height: 100%;	overflow: auto;	background-color:transparent!important;}
        .clip_resize {    width: 100%;    /* height: 100%; */    border-radius: 5px;    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;    border: 1px solid #ccc;    background-color: #fff;    padding: 1px;    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}
        </style>

        <title>Demo WebGis - Parco della Favorita - Palermo 2024 </title>
    </head>
    <body>
			
		<!-- Caricamento -->
<!-- jQuery, Helpers and jqueryIntrLoader -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
		<script src="js/jquery.easing.1.3.js"></script>
        <script src="js/spin.min.js"></script>
        <script src="js/jquery.introLoader.js"></script>
		<div id="element" class="introLoading"></div>
				<script>
			$(document).on('ready', function() {
				$("#element").introLoader({
                    animation: {
                        name: 'lettersLoader',
                        options: {
                            ease: "easeInOutCirc",
                            style: 'light',
                            delayBefore: 500,
                            delayAfter: 0,
                            exitTime: 300,
                            loaderText: 'Carta del suolo', 
                            lettersDelayTime: 0
							                        }
                    },
                    spinJs: {
                        lines: 50, // The number of lines to draw
                        length: 50, // The length of each line
                        radius: 80, // The radius of the inner circle
                        width: 3, // The line thickness
                        color: '#333' // #rgb or #rrggbb or array of colors
                    }
                });
			});
		</script>
		

	<!-- mappa       -->
        <div id="map"> 
<!-- Side Panel right -->
		<div id="mySidepanelRight" class="sidepanel" aria-label="side panel" aria-hidden="false">
			<div class="sidepanel-inner-wrapper">
				<nav class="sidepanel-tabs-wrapper" aria-label="sidepanel tab navigation">
				<!-- beta version       -->
		<div id="beta"><img src="images/beta.png" width="80" title="beta version" alt="beta version"></a></div>
					<ul class="sidepanel-tabs">
							<li class="sidepanel-tab">
							<a href="#" Title="Visualizza altri tematismi" class="sidebar-tab-link" role="tab" data-tab-link="tab-1">Mappe</a>
						</li>
                        <li class="sidepanel-tab">
							<a href="#" Title="Note" class="sidebar-tab-link" role="tab" data-tab-link="tab-2">Note</a>
						</li>
                        <li class="sidepanel-tab">
							<a href="#" Title="Filtri mappa corrente" class="sidebar-tab-link" role="tab" data-tab-link="tab-3">Filtri</a>
						</li>
					</ul>
				</nav>
				<div class="sidepanel-content-wrapper">
					<div class="sidepanel-content">
									<div class="sidepanel-tab-content" data-tab-content="tab-1">
							<h4>Indice - Parco della Favorita | 2024</h4>
							<p><a href="../cartografia_storica.html#15/38.1667/13.3432" target="_parent" Title="Cartografia storica" >01. Cartografia storica</a><br>
							<a href="../carta_del_suolo.html#15/38.1667/13.3432" Title="Cartografia storica" target="_parent">02. Carta del suolo</a><br>
							<a href="#" Title="bla bla bla" target="_parent">03. xxx xxx xxx </a><br>
							<a href="#" Title="bla bla bla" target="_parent">04. xxx xxx xxx </a><br>
							<a href="#" Title="bla bla bla" target="_parent">05. xxx xxx xxx </a><br>
							<a href="#" Title="bla bla bla" target="_parent">06. xxx xxx xxx </a><br>
							<a href="#" Title="bla bla bla" target="_parent">07. xxx xxx xxx </a><br>
							<a href="#" Title="bla bla bla" target="_parent">08. xxx xxx xxx </a><br>
							<a href="#" Title="bla bla bla" target="_parent">09. xxx xxx xxx </a><br>
							<a href="../incidenti_stra.html" Title="Analisi degli Incidenti stradali nel Parco della Favorita" target="_parent">10. Analisi degli Incidenti stradali nel Parco della Favorita </a><br>
							</p>
						</div>
                        <div  class="sidepanel-tab-content" data-tab-content="tab-2">
							<h4>Lorem ipsum</h4>
							<p> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed quis dolor sagittis, lacinia mauris eget, cursus ex. Vivamus convallis mauris orci, nec feugiat metus commodo sit amet. Suspendisse quis egestas dolor. Etiam convallis justo eu urna sagittis ultrices. Nulla quis feugiat felis. Phasellus accumsan libero purus, sagittis tempus felis sodales vitae. In hac habitasse platea dictumst. <br><br>

                                <a href="#" title="Tavola XXX |  Scarica la tavola in formato pdf " target="_blank">  
                                <img src="../../gallery/piano_uso/08_Carta uso del suolo.png" class="clip_resize" title="Carta del suolo | Scarica la tavola in formato pdf" border="0" /></a><br><br>

                                Aenean non arcu vitae nulla gravida dictum. Donec ut ante molestie, posuere neque ut, feugiat magna. Nunc laoreet sapien eu nulla ullamcorper tincidunt. Maecenas eget nulla sapien. Fusce bibendum ante nec gravida ultricies. Aliquam luctus lobortis ligula non commodo. Aliquam tempus, erat a aliquam porttitor, est purus porta nisl, in fermentum ante lacus id augue. Phasellus eget porta leo.r>
                            </p>
						</div>	
						<div  class="sidepanel-tab-content" data-tab-content="tab-3">
							<div id="filter"</div> <!-- <h4>Filtri</h4> -->
							<p> Permette di scegliere più campi e mostrerà la possibilità grafica di filtrare i dati visibili sulla mappa.</p>
						</div>					
					</div>
				</div>
			</div>
			<div class="sidepanel-toggle-container">
				<button class="sidepanel-toggle-button" type="button" aria-label="toggle side panel" title="Attiva il pannello dei filtri"></button>
			</div>		</div>			</div>

 
		<!-- Scripts -->
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <script src="js/L.Control.Layers.Tree.min.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="js/leaflet-measure.js"></script>
        <script src="js/tailDT.js"></script>
        <script src="js/nouislider.min.js"></script>
        <script src="js/wNumb.js"></script>
		<!-- script credits -->
		<script type="text/javascript" src="js/leaflet-control-credits.js"></script>
		<script type="text/javascript" src="js/Leaflet.GraphicScale.min.js"></script>
		  <!-- script automatico mobile/desktop --> 
		<script> if (screen && screen.width < 737) { document.write('<script type="text/javascript" src="js/Leaflet_GraphicScale_min_mobile.js"><\/script>'); } </script>
		<script> if (screen && screen.width > 738) { document.write('<script type="text/javascript" src="js/Leaflet_GraphicScale_min.js"><\/script>'); } </script> 
		  <script src="js/Leaflet.BigImage.js"></script>
		<script src="js/LControlMousePosition.js"></script>
		<script src="js/leaflet.zoomhome.min.js"></script>
		<script type="text/javascript" src="js/leaflet-history.js"></script>
		<script src="js/leaflet.fullscreen.js"></script>
		<script src="js/leaflet-sidepanel.js"></script>
		<script src="js/leaflet.scalefactor.js"></script>
		 <!-- script dati mappa --> 
        <script src="data/Cartausodelsuolo_3.js"></script>
        <script src="data/perimetro_parcofavorita_4.js"></script>
		<script src="data/Differenza_0.js"></script>
        <script>

	        var highlightLayer;
        function highlightFeature(e) {
            highlightLayer = e.target;

            if (e.target.feature.geometry.type === 'LineString' || e.target.feature.geometry.type === 'MultiLineString') {
              highlightLayer.setStyle({
                color: '#ff9900',
              });
            } else {
              highlightLayer.setStyle({
                fillColor: '#ff9900',
                fillOpacity: 0.5
              });
            }
			// mostra popup mouse 
           // .leaflet-top .leaflet-control
        }
		
        var map = L.map('map', {
            zoomControl:false, maxZoom:18, minZoom:13  }).fitBounds([[38.144322827528214,13.303485067067136],[38.18906926103667,13.382769795748876]]);
        var hash = new L.Hash(map);
        map.attributionControl.setPrefix('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> &middot; <a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> &middot; <a href="https://qgis.org">QGIS</a> - <a href="https://x.com/gbvitrano">by @gbvitrano</a> - ');
        var autolinker = new Autolinker({truncate: {length: 30, location: 'smart'}});
        // remove popup's row if "visible-with-data"
        function removeEmptyRowsFromPopupContent(content, feature) {
         var tempDiv = document.createElement('div');
         tempDiv.innerHTML = content;
         var rows = tempDiv.querySelectorAll('tr');
         for (var i = 0; i < rows.length; i++) {
             var td = rows[i].querySelector('td.visible-with-data');
             var key = td ? td.id : '';
             if (td && td.classList.contains('visible-with-data') && feature.properties[key] == null) {
                 rows[i].parentNode.removeChild(rows[i]);
             }
         }
         return tempDiv.innerHTML;
        }
        // add class to format popup if it contains media
		function addClassToPopupIfMedia(content, popup) {
			var tempDiv = document.createElement('div');
			tempDiv.innerHTML = content;
			if (tempDiv.querySelector('td img')) {
				popup._contentNode.classList.add('media');
					// Delay to force the redraw
					setTimeout(function() {
						popup.update();
					}, 10);
			} else {
				popup._contentNode.classList.remove('media');
			}
		}
<!-- Side panel Right --> 				
		const sidepanelRight = L.control.sidepanel('mySidepanelRight', {
			panelPosition: 'right',
			tabsPosition: 'top',
			pushControls: true,
			darkMode: false,
			startTab: 'tab-1'
		}).addTo(map);
		
        var measureControl = new L.Control.Measure({
            position: 'bottomleft',
            primaryLengthUnit: 'meters',
            secondaryLengthUnit: 'kilometers',
            primaryAreaUnit: 'sqmeters',
            secondaryAreaUnit: 'hectares'
        });
        measureControl.addTo(map);
        document.getElementsByClassName('leaflet-control-measure-toggle')[0].innerHTML = '';
        document.getElementsByClassName('leaflet-control-measure-toggle')[0].className += ' fas fa-ruler';
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
            if (bounds_group.getLayers().length) {
                map.fitBounds(bounds_group.getBounds());
            }
            map.setMaxBounds(map.getBounds());
        }
        map.createPane('pane_GoogleHybrid_0');
        map.getPane('pane_GoogleHybrid_0').style.zIndex = 400;
        var layer_GoogleHybrid_0 = L.tileLayer('https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}', {
            pane: 'pane_GoogleHybrid_0',
            opacity: 1.0,
            attribution: '<a href="https://www.google.at/permissions/geoguidelines/attr-guide.html">Map data ©2015 Google</a>',
            minZoom: 12,
            maxZoom: 18,
            minNativeZoom: 12,
            maxNativeZoom: 18
        });
        layer_GoogleHybrid_0;
        map.createPane('pane_OSMStandard_1');
        map.getPane('pane_OSMStandard_1').style.zIndex = 401;
        var layer_OSMStandard_1 = L.tileLayer('http://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            pane: 'pane_OSMStandard_1',
            opacity: 1.0,
            attribution: '<a href="https://www.openstreetmap.org/copyright">© OpenStreetMap contributors, CC-BY-SA</a>',
            minZoom: 12,
            maxZoom: 18,
            minNativeZoom: 12,
            maxNativeZoom: 18
        });
        layer_OSMStandard_1;
		map.addLayer (layer_OSMStandard_1)
		
		// carto 10k
        map.createPane('pane_PalermoCTR10K_2');
        map.getPane('pane_PalermoCTR10K_2').style.zIndex = 402;
        var layer_PalermoCTR10K_2 = L.tileLayer('https://siciliahub.github.io/palermohub/carto/ctr_pa_10k/{z}/{x}/{y}.png', {
            pane: 'pane_PalermoCTR10K_2',
            opacity: 1.0,
            attribution: ' <a href="https://www.sitr.regione.sicilia.it/download/download-carta-tecnica-regionale-10000/">Carta Tecnica Regionale 10K | Sicilia ATA 2013, CC BY 4.0</a>',
            minZoom: 12,
            maxZoom: 15,
            minNativeZoom: 12,
            maxNativeZoom: 15
        });
        layer_PalermoCTR10K_2;
        map.addLayer(layer_PalermoCTR10K_2);
		
				// carto favorita 2k
        map.createPane('pane_favorita2k_3');
        map.getPane('pane_favorita2k_3').style.zIndex = 402;
        var layer_favorita2k_3 = L.tileLayer('https://siciliahub.github.io/palermohub/carto/favorita_2k/{z}/{x}/{y}.png', {
            pane: 'pane_favorita2k_3',
            opacity: 1.0,
            attribution: ' <a href="https://www.sitr.regione.sicilia.it/download/download-carta-tecnica-regionale-10000/">Carta Tecnica Comunale 2K | Sicilia ATA 2009, CC BY 4.0</a>',
            minZoom: 16,
            maxZoom: 18,
            minNativeZoom: 16,
            maxNativeZoom: 18
        });
        layer_favorita2k_3;
		 map.addLayer(layer_favorita2k_3);
			// Area comune bucata
        function pop_Differenza_0(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){
                            feature.closePopup()
                        });
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['osm_id'] !== null ? autolinker.link(feature.properties['osm_id'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['class'] !== null ? autolinker.link(feature.properties['class'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['type'] !== null ? autolinker.link(feature.properties['type'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['name'] !== null ? autolinker.link(feature.properties['name'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['address'] !== null ? autolinker.link(feature.properties['address'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['extratags'] !== null ? autolinker.link(feature.properties['extratags'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 405 });
        }

        function style_Differenza_0_0() {
            return {
                pane: 'pane_Differenza_0',
                opacity: .1,
                color: 'rgba(35,35,35,.1)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: .7,
                fillColor: 'rgba(255,255,255,1)',
                interactive: false,
            }
        }
        map.createPane('pane_Differenza_0');
        map.getPane('pane_Differenza_0').style.zIndex = 405;
        map.getPane('pane_Differenza_0').style['mix-blend-mode'] = 'normal';
        var layer_Differenza_0 = new L.geoJson(json_Differenza_0, {
            attribution: '',
            interactive: false,
            dataVar: 'json_Differenza_0',
            layerName: 'layer_Differenza_0',
            pane: 'pane_Differenza_0',
            onEachFeature: pop_Differenza_0,
            style: style_Differenza_0_0,
        });
        bounds_group.addLayer(layer_Differenza_0);
        map.addLayer(layer_Differenza_0);
		
						
		// carta del suolo
        function pop_Cartausodelsuolo_3(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){
                            feature.closePopup()
                        });
                    }
                },
                mouseover: highlightFeature,
            });
			
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">Tipologia</th>\
                        <td class="visible-with-data" id="Layer">' + (feature.properties['Layer'] !== null ? autolinker.link(feature.properties['Layer'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Sigla</th>\
                        <td class="visible-with-data" id="Text">' + (feature.properties['Text'] !== null ? autolinker.link(feature.properties['Text'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Descrizione</th>\
                        <td class="visible-with-data" id="Descrizione">' + (feature.properties['Descrizione'] !== null ? autolinker.link(feature.properties['Descrizione'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        function style_Cartausodelsuolo_3_0(feature) {
            switch(String(feature.properties['Layer'])) {
                case 'Agrumeti':
                    return {
                pane: 'pane_Cartausodelsuolo_3',
                opacity: 1,
                color: 'rgba(35,35,35,0.8)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(255,254,197,0.8)',
                interactive: true,
            }
                    break;
                case 'Frutteti e vivai':
                    return {
                pane: 'pane_Cartausodelsuolo_3',
                opacity: 1,
                color: 'rgba(35,35,35,0.5615686274509804)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(255,196,255,0.8)',
                interactive: true,
            }
                    break;
                case 'Orti':
                    return {
                pane: 'pane_Cartausodelsuolo_3',
                opacity: 1,
                color: 'rgba(35,35,35,0.8)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(176,246,244,0.7215686274509805)',
                interactive: true,
            }
                    break;
                case 'Territori boscati e ambienti semi-naturali':
                    return {
                pane: 'pane_Cartausodelsuolo_3',
                opacity: 1,
                color: 'rgba(35,35,35,0.8)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(167,229,166,0.8)',
                interactive: true,
            }
                    break;
                case 'Vegetazione ornamentale':
                    return {
                pane: 'pane_Cartausodelsuolo_3',
                opacity: 1,
                color: 'rgba(35,35,35,0.8)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(248,212,214,0.8)',
                interactive: true,
            }
                    break;
                case 'Territori modellati artificialmente':
                    return {
                pane: 'pane_Cartausodelsuolo_3',
                opacity: 1,
                color: 'rgba(35,35,35,0.8)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(238,238,238,0.8)',
                interactive: true,
            }
                    break;
            }
        }
        map.createPane('pane_Cartausodelsuolo_3');
        map.getPane('pane_Cartausodelsuolo_3').style.zIndex = 403;
        map.getPane('pane_Cartausodelsuolo_3').style['mix-blend-mode'] = 'normal';
        var layer_Cartausodelsuolo_3 = new L.geoJson(json_Cartausodelsuolo_3, {
            attribution: '',
            interactive: true,
            dataVar: 'json_Cartausodelsuolo_3',
            layerName: 'layer_Cartausodelsuolo_3',
            pane: 'pane_Cartausodelsuolo_3',
            onEachFeature: pop_Cartausodelsuolo_3,
            style: style_Cartausodelsuolo_3_0,
        });
        bounds_group.addLayer(layer_Cartausodelsuolo_3);
        map.addLayer(layer_Cartausodelsuolo_3);
        function pop_perimetro_parcofavorita_4(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){
                            feature.closePopup()
                        });
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['OBJECTID'] !== null ? autolinker.link(feature.properties['OBJECTID'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CODICE_REG'] !== null ? autolinker.link(feature.properties['CODICE_REG'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['NOME_AREA'] !== null ? autolinker.link(feature.properties['NOME_AREA'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['AREA_KMQ'] !== null ? autolinker.link(feature.properties['AREA_KMQ'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATUM'] !== null ? autolinker.link(feature.properties['DATUM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['PROIEZIONE'] !== null ? autolinker.link(feature.properties['PROIEZIONE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['FUSO'] !== null ? autolinker.link(feature.properties['FUSO'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['LAT_MT'] !== null ? autolinker.link(feature.properties['LAT_MT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['LON_MT'] !== null ? autolinker.link(feature.properties['LON_MT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['RIF_LEGGE'] !== null ? autolinker.link(feature.properties['RIF_LEGGE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['REGIONE'] !== null ? autolinker.link(feature.properties['REGIONE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['PROVINCIA'] !== null ? autolinker.link(feature.properties['PROVINCIA'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['COMUNE'] !== null ? autolinker.link(feature.properties['COMUNE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['TIPOLOGIA'] !== null ? autolinker.link(feature.properties['TIPOLOGIA'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ZONA'] !== null ? autolinker.link(feature.properties['ZONA'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['TIPO_SITO'] !== null ? autolinker.link(feature.properties['TIPO_SITO'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['REG_BIOG'] !== null ? autolinker.link(feature.properties['REG_BIOG'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ANNO_ISTIT'] !== null ? autolinker.link(feature.properties['ANNO_ISTIT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATA_ISTIT'] !== null ? autolinker.link(feature.properties['DATA_ISTIT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['GESTORE'] !== null ? autolinker.link(feature.properties['GESTORE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CAP'] !== null ? autolinker.link(feature.properties['CAP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['TEL'] !== null ? autolinker.link(feature.properties['TEL'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CELL'] !== null ? autolinker.link(feature.properties['CELL'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INDIRIZZO'] !== null ? autolinker.link(feature.properties['INDIRIZZO'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['MAIL'] !== null ? autolinker.link(feature.properties['MAIL'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['Shape.STArea()'] !== null ? autolinker.link(feature.properties['Shape.STArea()'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['Shape.STLength()'] !== null ? autolinker.link(feature.properties['Shape.STLength()'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        function style_perimetro_parcofavorita_4_0() {
            return {
                pane: 'pane_perimetro_parcofavorita_4',
                opacity: 1,
                color: 'rgba(215,25,28,1.0)',
                dashArray: '5.0,1.0',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 3.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(224,209,134,0.0)',
                interactive: false,
            }
        }
        map.createPane('pane_perimetro_parcofavorita_4');
        map.getPane('pane_perimetro_parcofavorita_4').style.zIndex = 404;
        map.getPane('pane_perimetro_parcofavorita_4').style['mix-blend-mode'] = 'normal';
        var layer_perimetro_parcofavorita_4 = new L.geoJson(json_perimetro_parcofavorita_4, {
            attribution: '',
            interactive: false,
            dataVar: 'json_perimetro_parcofavorita_4',
            layerName: 'layer_perimetro_parcofavorita_4',
            pane: 'pane_perimetro_parcofavorita_4',
            onEachFeature: pop_perimetro_parcofavorita_4,
            style: style_perimetro_parcofavorita_4_0,
        });
        bounds_group.addLayer(layer_perimetro_parcofavorita_4);
        map.addLayer(layer_perimetro_parcofavorita_4);
		
	
        var baseMaps = {};

        var overlaysTree = [
		{label: 'Parco della Favorita  &#x1f5fa;, <div class="leaflet-control-layers-separator"></div>'},

		{label: '<img src="legend/spot.png" /> Area Parco della Favorita', layer: layer_Differenza_0},
            {label: ' <img src="legend/perimetro_parcofavorita_4.png" /> Perimetro Parco della Favorita' , layer: layer_perimetro_parcofavorita_4},
		
        {label: '<b>Carta uso del suolo</b>', selectAllCheckbox: true, children: [
		{label: 'Tipologie<br /><table><tr><td style="text-align: center;"><img src="legend/Cartausodelsuolo_3_Agrumeti0.png" /></td><td>Agrumeti</td></tr><tr><td style="text-align: center;"><img src="legend/Cartausodelsuolo_3_Fruttetievivai1.png" /></td><td>Frutteti e vivai</td></tr><tr><td style="text-align: center;"><img src="legend/Cartausodelsuolo_3_Orti2.png" /></td><td>Orti</td></tr><tr><td style="text-align: center;"><img src="legend/Cartausodelsuolo_3_Territoriboscatieambientiseminaturali3.png" /></td><td>Territori boscati e ambienti semi-naturali</td></tr><tr><td style="text-align: center;"><img src="legend/Cartausodelsuolo_3_Vegetazioneornamentale4.png" /></td><td>Vegetazione ornamentale</td></tr><tr><td style="text-align: center;"><img src="legend/Cartausodelsuolo_3_Territorimodellatiartificialmente5.png" /></td><td>Territori modellati artificialmente</td></tr></table>', layer: layer_Cartausodelsuolo_3},]},

			{label: 'Palermo CTC 2K (Zoom 15-18)', layer: layer_favorita2k_3},
			{label: 'Palermo CTR 10K', layer: layer_PalermoCTR10K_2},
			
            {label: 'OSM Standard', layer: layer_OSMStandard_1},
            {label: 'Google Hybrid', layer: layer_GoogleHybrid_0},]
        var lay = L.control.layers.tree(null, overlaysTree,{
            //namedToggle: true,
            //selectorBack: false,
            //closedSymbol: '&#8862; &#x1f5c0;',
            //openedSymbol: '&#8863; &#x1f5c1;',
            //collapseAll: 'Collapse all',
            //expandAll: 'Expand all',
            collapsed: true, 
        });
        lay.addTo(map);
        setBounds();

	<!--.zoomControl etichetta off") -->
		map.on("zoomend", function(){

            if (map.hasLayer(layer_Cartausodelsuolo_3)) {
                if (map.getZoom() <= 18 && map.getZoom() >= 15) {
                    layer_Cartausodelsuolo_3.eachLayer(function (layer) {
                        layer.openTooltip();
                    });
                } else {
                    layer_Cartausodelsuolo_3.eachLayer(function (layer) {
                        layer.closeTooltip();
                    });
                }
            }
           });
		  <!-- fine zoomControl etichetta off ) -->
						
				<!--.zoomControl etichetta  on) -->		
        var i = 0;
        layer_Cartausodelsuolo_3.eachLayer(function(layer) {
            var context = {
                feature: layer.feature,
                variables: {}
            };
            layer.bindTooltip((layer.feature.properties['Text'] !== null?String('<div style="color: #4E4B4B; font: bold 10px Arial; background-color: #ede9e9; border-radius: 2px;  -moz-border-radius: 2px;  -webkit-border-radius: 2px; box-shadow: 0 1px 5px rgba(0,0,0,0.6); padding: 2px 2px; ">' + layer.feature.properties['Text']) + '</div>':''), {permanent: true, offset: [-0, -10], className: 'css_Cartausodelsuolo_3'});
            labels.push(layer);
            totalMarkers += 1;
              layer.added = true;
              addLabel(layer, i);
              i++;
        });
		            if (map.hasLayer(layer_Cartausodelsuolo_3)) {
                if (map.getZoom() <= 18 && map.getZoom() >= 15) {
                    layer_Cartausodelsuolo_3.eachLayer(function (layer) {
                        layer.openTooltip();
                    });
                } else {
                    layer_Cartausodelsuolo_3.eachLayer(function (layer) {
                        layer.closeTooltip();
                    });
                }
              }
			  
        var mapDiv = document.getElementById('filter');
        var row = document.createElement('div');
        row.className="row";
        row.id="all";
        row.style.height = "100%";

		//row.style.background = "#a8d3df";
        var col1 = document.createElement('div');
        col1.className="col9";
        col1.id = "mapWindow";
        col1.style.height = "99%";
        col1.style.width = "80%";
        col1.style.display = "inline-block";
		//col1.style.background = "azure";
        var col2 = document.createElement('div');
        col2.className="col3";
        col2.id = "menu";
        col2.style.display = "inline-block";
		col2.style.background = "transparent";
        mapDiv.parentNode.insertBefore(row, mapDiv);
        document.getElementById("all").appendChild(col1);
        document.getElementById("all").appendChild(col2);
        col1.appendChild(mapDiv)
        var Filters = {"Layer": "str"};
        function filterFunc() {
          map.eachLayer(function(lyr){
          if ("options" in lyr && "dataVar" in lyr["options"]){
            features = this[lyr["options"]["dataVar"]].features.slice(0);
            try{
              for (key in Filters){
                keyS = key.replace(/[^a-zA-Z0-9_]/g, "")
                if (Filters[key] == "str" || Filters[key] == "bool"){
                  var selection = [];
                  var options = document.getElementById("sel_" + keyS).options
                  for (var i=0; i < options.length; i++) {
                    if (options[i].selected) selection.push(options[i].value);
                  }
                    try{
                      if (key in features[0].properties){
                        for (i = features.length - 1;
                          i >= 0; --i){
                          if (selection.indexOf(
                          features[i].properties[key])<0
                          && selection.length>0) {
                          features.splice(i,1);
                          }
                        }
                      }
                    } catch(err){
                  }
                }
                if (Filters[key] == "int"){
                  sliderVals =  document.getElementById(
                    "div_" + keyS).noUiSlider.get();
                  try{
                    if (key in features[0].properties){
                    for (i = features.length - 1; i >= 0; --i){
                      if (parseInt(features[i].properties[key])
                          < sliderVals[0]
                          || parseInt(features[i].properties[key])
                          > sliderVals[1]){
                            features.splice(i,1);
                          }
                        }
                      }
                    } catch(err){
                    }
                  }
                if (Filters[key] == "real"){
                  sliderVals =  document.getElementById(
                    "div_" + keyS).noUiSlider.get();
                  try{
                    if (key in features[0].properties){
                    for (i = features.length - 1; i >= 0; --i){
                      if (features[i].properties[key]
                          < sliderVals[0]
                          || features[i].properties[key]
                          > sliderVals[1]){
                            features.splice(i,1);
                          }
                        }
                      }
                    } catch(err){
                    }
                  }
                if (Filters[key] == "date"
                  || Filters[key] == "datetime"
                  || Filters[key] == "time"){
                  try{
                    if (key in features[0].properties){
                      HTMLkey = key.replace(/[&\/\\#,+()$~%.'":*?<>{} ]/g, '');
                      startdate = document.getElementById("dat_" +
                        HTMLkey + "_date1").value.replace(" ", "T");
                      enddate = document.getElementById("dat_" +
                        HTMLkey + "_date2").value.replace(" ", "T");
                      for (i = features.length - 1; i >= 0; --i){
                        if (features[i].properties[key] < startdate
                          || features[i].properties[key] > enddate){
                          features.splice(i,1);
                        }
                      }
                    }
                  } catch(err){
                  }
                }
              }
            } catch(err){
            }
          this[lyr["options"]["layerName"]].clearLayers();
          this[lyr["options"]["layerName"]].addData(features);
		  

        var i = 0;
        layer_Cartausodelsuolo_3.eachLayer(function(layer) {
            var context = {
                feature: layer.feature,
                variables: {}
            };
            layer.bindTooltip((layer.feature.properties['Text'] !== null?String('<div style="color: #4E4B4B; font: bold 10px Arial; background-color: #ede9e9; border-radius: 2px;  -moz-border-radius: 2px;  -webkit-border-radius: 2px; box-shadow: 0 1px 5px rgba(0,0,0,0.6); padding: 2px 2px; ">' + layer.feature.properties['Text']) + '</div>':''), {permanent: true, offset: [-0, -10], className: 'css_Cartausodelsuolo_3'});
            labels.push(layer);
            totalMarkers += 1;
              layer.added = true;
              addLabel(layer, i);
              i++;
        });
          }
          })
        }
            document.getElementById("menu").appendChild(
                document.createElement("div"));
            var div_Layer = document.createElement('div');
            div_Layer.id = "div_Layer";
            div_Layer.className= "filterselect";
            document.getElementById("menu").appendChild(div_Layer);
            sel_Layer = document.createElement('select');
            sel_Layer.multiple = true;
            sel_Layer.size = 6;
            sel_Layer.id = "sel_Layer";
            var Layer_options_str = "<option value='' unselected></option>";
            sel_Layer.onchange = function(){filterFunc()};
            Layer_options_str  += '<option value="Agrumeti">Agrumeti</option>';
            Layer_options_str  += '<option value="Frutteti e vivai">Frutteti e vivai</option>';
            Layer_options_str  += '<option value="Orti">Orti</option>';
            Layer_options_str  += '<option value="Territori boscati e ambienti semi-naturali">Territori boscati e ambienti semi-naturali</option>';
            Layer_options_str  += '<option value="Territori modellati artificialmente">Territori modellati artificialmente</option>';
            Layer_options_str  += '<option value="Vegetazione ornamentale">Vegetazione ornamentale</option>';
            sel_Layer.innerHTML = Layer_options_str;
            div_Layer.appendChild(sel_Layer);
            var lab_Layer = document.createElement('div');
            lab_Layer.innerHTML = 'Tipologia';
            lab_Layer.className = 'filterlabel';
            div_Layer.appendChild(lab_Layer);
            var reset_Layer = document.createElement('div');
            reset_Layer.innerHTML = 'Cancella filtro';
            reset_Layer.className = 'filterlabel';
            reset_Layer.onclick = function() {
                var options = document.getElementById("sel_Layer").options;
                for (var i=0; i < options.length; i++) {
                    options[i].selected = false;
                }
                filterFunc();
            };
            div_Layer.appendChild(reset_Layer);
        resetLabels([layer_Cartausodelsuolo_3]);
        map.on("zoomend", function(){
            resetLabels([layer_Cartausodelsuolo_3]);
        });
        map.on("layeradd", function(){
            resetLabels([layer_Cartausodelsuolo_3]);
        });
        map.on("layerremove", function(){
            resetLabels([layer_Cartausodelsuolo_3]);
        });
		
		
	<!-- plugin accessori -->   
// var bigImage = L.control.bigImage({position: 'topleft'});bigImage.addTo(map);

<!-- scala mappa -->		
	<!-- scala mappa -->		
		var graphicScale = L.control.graphicScale({
		doubleLine: true,
		fill: 'hollow',
        showSubunits: true
	}).addTo(map);
	
	<!-- cronologia -->
new L.HistoryControl({}).addTo(map);	

	<!-- stampa mamma -->
L.control.bigImage({position: 'bottomleft'}).addTo(map);	
	
<!-- muose coordinate -->
L.control.mousePosition().addTo(map);
				<!-- zoomhome-->  
var zoomHome = L.Control.zoomHome();zoomHome.addTo(map);

<!-- full Screen -->  
 L.control.fullScreenButton({
                    position: 'topleft',
                    title: 'Toggle fullscreen mode',
                    enterFullScreenIcon: 'images/full_screen.png',
                    exitFullScreenIcon: 'images/general_screen.png',
                    enterFullScreenTitle: 'Enter fullscreen mode',
                    exitFullScreenTitle: 'Exit fullscreen mode',
                    onFullScreenChange: (isFullScreen) => {
                        console.log(`FullScreen mode is now ${isFullScreen ? 'ON' : 'OFF'}`);
                    },
                })
                .addTo(map)
				
<!-- scala 1:2000 --> 
L.control.scalefactor().addTo(map);

<!-- credits -->   
    credits = L.controlCredits({
        	imageurl: 'images/aqu.png',
          imagealt: 'gbvitrano credits',
        	tooltip: "Rigenerazione funzionale dell'area verde ed attrezzata del Parco della Favorita",
        	width: '45px',
        	height: '45px',
        	expandcontent: 'Interactive mapping<br/>by <a href="https://www.comune.palermo.it/index.php" target="_blank">gbvitrano per Comune di Palermo</a>',
        }).addTo(map);

        </script>

    </body>
</html>
